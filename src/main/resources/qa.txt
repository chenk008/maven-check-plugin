����ص�
�������������ͻ����ͨ�����pom.xml�����maven�������֮������gid��aid��version����������Ų������¼������㣺
1��������������������ȫ��һ���޷�ʶ����Ƿ��ͻ��
2��һ����������һ���������޷�ʶ�������Ƿ���ڲ��ֳ�ͻ��
3���������ǳ��Ӵ󣬿�����Ա�����©��һ����ͻ��
4��pom����δ�䣬�������ı仯��δ֪�Ὺ����Ա�����²����µĳ�ͻ��
Ϊ���ֲ��������㣬���������ֱ���ٲ÷��������ݵķ�ʽ������ÿ����Ӷ��ȷ���ҳ�Ǳ�ڵ���в��
��׼��maven��������Ժܷ����ʹ�ã��Լ���������ϵͳ�����磺aone

 

�������
mvn pv:check 
֧���κδ����ʽ��maven���̡�jar��war��ear�ȡ�

mvn pv:check-war 
ר��Ϊwar������ƣ�����war���libĿ¼�е�jar��ͻ�� ע��check���ɨ��maven��������check-war���ɨ��war��libĿ¼��

���ʹ��
�ֶ�����
ֱ�������������С�



�Զ����У����������ڡ���pom�ж��壨����ֱ�Ӷ����ڵ�ǰ���̣�Ҳ���Զ����ڵ�ǰ���̵ĸ�POM�ϣ�
pv:check ��Ĭ�ϰ� generate-sources �������ڣ����󶨺����в������Ҫʲô����Ĳ�����������Ŀ����Զ�����ɨ�衣

<plugin>
  <groupId>org.ck.maven.plugins</groupId>
  <artifactId>maven-pv-plugin</artifactId>
  <version>${pv.version}</version>
  <executions>
    <execution>
      <id>check</id>
      <goals>
        <goal>check</goal>
      </goals>
    </execution>
  </executions>
</plugin>
 pv:check-war ��Ĭ�ϰ� package �������ڣ����󶨺����в������Ҫʲô����Ĳ�����war���ʱ����Զ�����ɨ�衣

<plugin>
  <groupId>org.ck.maven.plugins</groupId>
  <artifactId>maven-pv-plugin</artifactId>
  <version>${pv.version}</version>
  <executions>
    <execution>
      <id>check-war</id>
      <goals>
        <goal>check-war</goal>
      </goals>
    </execution>
  </executions>
</plugin>

���ɨ������һ���ٲñ��棬������Ա�������ٲñ�������˹����г�ͻ�޸��ˡ�




�ٲñ����������˵��
Id����ͻ��ţ�һ��Ψһ��ʶ���ں���ɨ���л��õ���
Level����ͻ������3��ֵ��һ����fatal��һ����error��һ����warn��
          fatal�������ͻ�����ų��п��ܻ�������غ��������ּ���ĳ�ͻ��
          error�������ͻ���Բ��ų��ͻ��ɨ�跢��MD5����һ��ģ�����ֻ����������Ӱ������ȶ��������ų�һ�¡�
          warn�������ͻ����һ����������غ��������֮��ֻ�ǲ��ֳ�ͻ�����ʧ�ܣ�ֻ����ʾ���ѡ���*������Ա�����ж��Ƿ�Ҫ���?
Count��ɨ�赽�����ͻ��һ���ж��ٸ����ͻ��
Detail��ÿ�����������֣��������������jarһ�������ٸ���

С��ʾ����ο����ٲñ��棬�жϵ����ĸ�����Ӧ�ñ��ߵ���

����
1��a.jar��b.jar��a.jar����10���࣬b.jar����10���࣬ɨ�赽��ͻcount��10����
����Ȼ2����100%��ͻ����ͻ����fatal�������Ų顣2������ų��һ��
2��a1.jar��b1.jar��a1.jar����10���࣬b1.jar����10���࣬ɨ�赽��ͻcount��10����
����Ȼ2����100%��ͻ������ɨ�跢�ֶ���MD5һ�£���ͻ����error����ͻ�İ�Ӱ������ȶ���ֻ�Ǵ���������󣬽����ų�һ����
3��c.jar��d.jar��c.jar����10���࣬d.jar����6���࣬ɨ�赽��ͻcount��6����
����Ȼc.jarһ������d.jar�������࣬��ͻ����error�������Ų顣Ӧ�ð�d.jar�ų�
4��e.jar��f.jar��e.jar����20���࣬f.jar����15���࣬ɨ�赽��ͻcount��10����
����Ͳ���˵�ˣ�2��ֻ�ǲ��ֳ�ͻ����һ����������ͻ����warn���Ƿ������������������������Ա�����жϡ�



�����־���˵��
B2B���Ա���mvn�ֿ�ϲ���ͬ�����ͻ������һֱ�������ǣ�Ŀǰ�Ѿ��ڶ���pom��������һ��ͬ�����ͻ�ļ��������ÿ�α����ʱ��Ĭ��ִ�У����ڱ�����־�������ͻ���顣

һ�������ǳ�ͻ��־����ϸ���

�����־	ע��
[INFO] [pv:check{execution:check}] 
[INFO] Check project packaging type : war,ali-war 
[INFO] Check dependency without scope type : test,provided 
���� 
[INFO] Scan to 484 dependencies 
[INFO] +- activation-1.1.jar:compile 
[INFO] +- ajax.json.java-0.0.0.jar:compile 
[INFO] +- ajax.jsonlib-0.0.0.jar:compile 
���� 
conflict output begin 
--------------------------------------------------------------------------------------------- 
The jars conflict. 
Id : jetty-util-6.1.26.jar,server.jetty.jetty-util-6.1.21.jar 
Level : fatal 
Count : 105 
Detail : 
org.mortbay.jetty:jetty-util:jar:6.1.26:compile >> jetty-util-6.1.26.jar (105) 
org.mortbay.jetty:jetty-util:jar:6.1.26:compile >> jetty-util-6.1.26.jar (105) 
----------------------------------------------------------------------------------------------------------------  
The jars may be the inclusion relationship conflict. 
Id : commons-beanutils-1.8.0.jar,commons-beanutils-core-1.8.0.jar 
Level : fatal 
Count : 118 
Detail : 
commons-beanutils:commons-beanutils:jar:1.8.0:compile >> commons-beanutils-1.8.0.jar (137)  
commons-beanutils:commons-beanutils-core:jar:1.8.0:compile >> commons-beanutils-core-1.8.0.jar (118) 
---------------------------------------------------------------------------------------------------------------- 
The conflict jars has the same MD5 value. 
Id : xml.dom4j-1.6.1.jar,dom4j-1.6.1.jar 
Level : error 
Count : 190 
Detail : 
dom4j:dom4j:jar:1.6.1:compile >> dom4j-1.6.1.jar (190) 
----------------------------------------------------------------------------------------------------------------- 
The jars cannot determine the logic of conflict. 
Id : jsp-2.1-6.1.14.jar,jasper-compiler-5.5.23.jar 
Level : warn 
Count : 144 
Detail : 
org.mortbay.jetty:jsp-2.1:jar:6.1.14:compile >> jsp-2.1-6.1.14.jar (585) 
tomcat:jasper-compiler:jar:5.5.23:runtime >> jasper-compiler-5.5.23.jar (180) 
---------------------------------------------------------------------------------------------- 
conflict output end 
****************************************************** 
[INFO] [pv*-fatal] : Scan the dependencies found conflict. ( 138 ) 
[INFO] fatal level : 67 
[INFO] error level : 12 
[INFO] warn  level : 59 

�����Ƽ���ʼ��� 
�������ϸ˵���ĵ�������Ҳ���ֹ��������ʽ���� 
����pom��Ĭ��ָ���������packaging���� 
����pom��Ĭ��ָ���������jar��Ч��Χ 
  
��war�����jar������������г���war�е�jar 
  
  
  
  
  
��ͻ��jar�����ʼ 
------------------------------------------------------------------------------ 
����jar��class������ȣ�����md5��һ�£����ֳ�ͻ������ͬһ�������벻ͬ��겻ͬ�汾��jar�����ַ�������������ģ������ų� 
  
  
  
  

  


------------------------------------------------------------------------------------------------- 
��ͻ��class�����պõ�������class����С��jar,���ֳ�ͻ�����Ǹ�����Ӱ�Ĺ�ϵ�������ȫ���Ƿ��ղ������汾��һ����Ҳ����������ġ���Ҫ�������ų�webx2�ȿ�ܵ�jar��������ܶࡣ 
  
  
  

  

------------------------------------------------------------------------------------------------ 
���ֳ�ͻ��ͬһ���������˲�ͬ����jar����Ϊ��md5��һ�µģ���������ϲ�����ɷ��գ����ǻᵼ��war�������࣬�����ų�������Ҳ���ںͼܹ�ʦһ���ڸ�ͳһ��������� 
  
  
  
  
  -------------------------------------------------------------------------------------------------- 
��ͻ��class�����������κ�һ��jar�����ֳ�ͻ�޷��жϳ�ͻ���߼���ϵ��һ����Ѽ򵥵��ų�����һ���� 
  
  
  
  
  
------------------------------------------------------------------------------------------------- 
��ͻ��jar������� 
********************************************** 
������ͻ�������Լ����ּ����ͻ������
 

������ͻ�������

1��Ŀǰ�����������ĳ�ͻ���ᵼ��aone�ϱ������ʧ�ܣ�ֻ��Ϊ���������ͻ��һ���ο���Ϣ

 

2��������վ��ɨ�����������󲿷�Ӧ�õĳ�ͻ��������100���ϣ�����Ϊʲô��Щ��ͻƽʱ���������������쳣�أ� ������Ϊjvm��class���ػ��������˵���ȶ��ģ��������ǰ�����ĸ����ķ�ʽ����class�� ���������ȶ�������Ϊ�����ı䶯���ƻ������ǻ���ǿ�ҽ��鿪���������ų�һЩ��ͻ�߼���ȷ�ĳ�ͻ��

3�����ʵ����Ŀ��������Ϊͬ�����ͻ�����쳣һ�㶼����Ϊ��Ŀ�����������µ�������������Ϊ���õ�����ΪSNAPSHOT�汾�����¼���������µ��������µĳ�ͻ����ǰ������ǿ����Լ������µ�jar�������ڱ��������־�ĳ�ͻ��������������jar������û�г�ͻ��

Aone����ʵ�ֵķ��������Ǽ������ɵĳ�ͻ���ȶ��ģ�aone����ÿ�η����ɹ������ɰ��jar�б?�Լ���ͻ�б?��֧ÿ�α���ͬ����һ��jar�б�ͳ�ͻ�б?���бȶԣ����Ѳ�����ʾ���û��������ʵ��Ҫ��aone������߹�ͨ��

4���������mvn����ںϣ���ͻ�Ľ��ע����һ����޶��ӵĹ�������ܻ�owner��Эͬ����BU�ļܹ�ʦ�������Լ�һЩ���ĵ�mavenר��һ��ϵͳ���ƽ����������




�߼����� (pv:check����)
Ĭ��check�����ɨ����������Ĺ��̣�������ֻɨ��war��car�� *1.1�汾����
���ò���checkPackaging

<plugin>
    <groupId>org.ck.maven.plugins</groupId>
    <artifactId>maven-pv-plugin</artifactId>
    <version>${pv.version}</version>
    <executions>
      <execution>
        <id>check</id>
        <goals>
          <goal>check</goal>
        </goals>
        <configuration>
          <!-- Ĭ��Ϊ�գ������ô˲����ʾ�����ƹ�������-->
          <checkPackaging>war,car</checkPackaging>
        </configuration>
      </execution>
    </executions>
</plugin>
Ĭ��check�����ɨ���������͵�����������ɨ��test��provided���͵�scope�� *1.1�汾����
���ò���checkWithoutScope

<plugin>
    <groupId>org.ck.maven.plugins</groupId>
    <artifactId>maven-pv-plugin</artifactId>
    <version>${pv.version}</version>
    <executions>
      <execution>
        <id>check</id>
        <goals>
          <goal>check</goal>
        </goals>
        <configuration>
          <!-- Ĭ��Ϊ�գ������ô˲����ʾȫ������scope��ɨ��-->
          <checkWithoutScope>test,provided,system</checkWithoutScope>
        </configuration>
      </execution>
    </executions>
</plugin>
�߼����� (pv:check��pv:check-warͨ��)
ɨ���fatal����ĳ�ͻ��ϣ�����ʧ�ܡ����ʧ����β�����
���ò���isTerminatePackaging

<plugin>
    <groupId>org.ck.maven.plugins</groupId>
    <artifactId>maven-pv-plugin</artifactId>
    <version>${pv.version}</version>
    <executions>
      <execution>
        <id>check-war</id>
        <goals>
          <goal>check-war</goal>
        </goals>
        <configuration>
          <!-- Ĭ�� false -->
          <isTerminatePackaging>true</isTerminatePackaging>
        </configuration>
      </execution>
    </executions>
</plugin>
ɨ���fatal����ĳ�ͻ��ϣ��ɾ���õİ�
ͬʱ���ò���isDeleteFailurePackage��isTerminatePackaging

<plugin>
    <groupId>org.ck.maven.plugins</groupId>
    <artifactId>maven-pv-plugin</artifactId>
    <version>${pv.version}</version>
    <executions>
      <execution>
        <id>check-war</id>
        <goals>
          <goal>check-war</goal>
        </goals>
        <configuration>
          <!-- ����2��������Ҫͬʱ����Ϊtrue -->
          <!-- Ĭ�� false -->
          <isTerminatePackaging>true</isTerminatePackaging>
          <!-- Ĭ�� false -->
          <isDeleteFailurePackage>true</isDeleteFailurePackage>
        </configuration>
      </execution>
    </executions>
</plugin>
ɨ���error��warn����ĳ�ͻ��Ҳϣ���ܵ��϶������õ�Ӱ�죨��ʾ����ʧ�ܡ�ɾ�����ʧ�ܵİ�
������һ���������level��ָ������Ϊwarn����error

<plugin>
    <groupId>org.ck.maven.plugins</groupId>
    <artifactId>maven-pv-plugin</artifactId>
    <version>${pv.version}</version>
    <executions>
      <execution>
        <id>check-war</id>
        <goals>
          <goal>check-war</goal>
        </goals>
        <configuration>
          <!-- ͬʱ��������3������ -->
          <!-- Ĭ�� fatal -->
          <level>error</level>
          <!-- Ĭ�� false -->
          <isTerminatePackaging>true</isTerminatePackaging>
          <!-- Ĭ�� false -->
          <isDeleteFailurePackage>true</isDeleteFailurePackage>
        </configuration>
      </execution>
    </executions>
</plugin>
�����ϸ�warn�����ɨ�赽��һ����ͻ���������Ϊ�Ǻ���ģ����ų������ͻ����ʾ��ô�죿
����һ��warn�����б?Ҫ�����ĸ���ͻ�д�ĸ���ͻ���ID��

<plugin>
    <groupId>org.ck.maven.plugins</groupId>
    <artifactId>maven-pv-plugin</artifactId>
    <version>${pv.version}</version>
    <executions>
      <execution>
        <id>check-war</id>
        <goals>
          <goal>check-war</goal>
        </goals>
        <configuration>
          <!-- ͬʱ��������4������ -->
          <!-- Ĭ�� fatal -->
          <level>warn</level>
          <!-- Ĭ�� false -->
          <isTerminatePackaging>true</isTerminatePackaging>
          <!-- Ĭ�� false -->
          <isDeleteFailurePackage>true</isDeleteFailurePackage>
          <!-- warn�����ͻ�����б?��д��ͻ��ID -->
          <excludes>
            <exclude>xxxxxxxx</exclude>
          </excludes>
        </configuration>
      </execution>
    </executions>
</plugin>
�߼����� (pv:check-war����)
*��ͨ������Ҫ���ǣ�����·��target�����Զ���·����
����target����

*��ͨ������Ҫ���ǣ��ҵ�web����pom���ú����⣬��������ɲ�����Ĭ��·����
����war·������warDirPath��warPath